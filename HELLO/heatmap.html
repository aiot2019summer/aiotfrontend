<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,height=device-height">
    <title>热力图</title>
    <style>::-webkit-scrollbar{display:none;}html,body{overflow:hidden;height:100%;margin:0;}</style>
</head>
<body>
<div id="mountNode"></div>
<script>/*Fixing iframe window.innerHeight 0 issue in Safari*/document.body.clientHeight;</script>
<script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g2-3.5.1/dist/g2.min.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.data-set-0.10.1/dist/data-set.min.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/lib/jquery-3.2.1.min.js"></script>

<script>
  var map = {},newList=[];
  $.getJSON('heatmap.json', function(cars) {    //获取坐标json数组保存在cars中
    for (var i = 0; i < cars.length; i++){
	     var m=10;                               //图像横轴以m为间隔,纵轴以m为间隔分割成一个个区间
	     var new_data=cars;
       new_data[i].g=parseInt(cars[i].x/m); //获取x所属区间的行索引
       new_data[i].l=parseInt(cars[i].y/m);//获取y所属区间的列索引
    }
   for (var i = 0; i < new_data.length; i++) {
       var obj = new_data[i];
       if ((!(map[obj.g]))&&(!(map[obj.l]))) {
         newList.push({
          g: obj.g,
		    	l:obj.l,
          tmp: 1
        });   
       map[obj.g,obj.l] = obj;}//将不重复元素放入obj中
      
	     else {
         for (var j = 0; j < newList.length; j++) {
           if ((newList[j].g == obj.g )&& (newList[j].l==obj.l)) { 
             newList[j].tmp++;
             break;
           }
         }
       }
     }
   })
console.log(newList);
var chart = new G2.Chart({   //开始画图
  container: 'mountNode',
  forceFit: true,
  height: window.innerHeight,
  padding: [0, 30, 60, 30]
});
chart.source(newList);
chart.tooltip({
  showTitle: false
});
chart.axis(false);
chart.legend({
  offset: 10
});
chart.heatmap().position('g*l').color('tmp', '#F51D27-#FA541C-#FF8C12-#FFC838-#FAFFA8-#80FF73-#12CCCC-#1890FF-#6E32C2');
chart.guide().image({
  start: ['min', 'max'],
  end: ['max', 'min'],
  src: 'https://gw.alipayobjects.com/zos/rmsportal/NeUTMwKtPcPxIFNTWZOZ.png'
});
chart.render();


</script>
</body>
</html>
